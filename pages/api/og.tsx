import { ImageResponse } from '@vercel/og';
import { NextRequest } from 'next/server';

export const config = {
  runtime: 'edge',
};

export default function handler(req: NextRequest) {
  try {
    const { searchParams } = new URL(req.url);

    // ?title=<title>
    const hasTitle = searchParams.has('title');
    const title = hasTitle
      ? searchParams.get('title')?.slice(0, 100)
      : '';

    return new ImageResponse(
      (
        <div
          style={{
            backgroundColor: 'black',
            backgroundSize: '150px 150px',
            height: '100%',
            width: '100%',
            display: 'flex',
            textAlign: 'center',
            alignItems: 'center',
            justifyContent: 'center',
            flexDirection: 'column',
            flexWrap: 'nowrap',
          }}
        >
          <div
            style={{
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              justifyItems: 'center',
            }}
          >
            <img
              alt="Shumayl.com"
              height={200}
              src="data:image/svg+xml,%3Csvg width='116' height='100' fill='white' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M 199.2 71.4 L 186.6 71.4 L 186.6 21.8 L 199 21.8 L 199 27.2 L 200.8 27.2 A 9.844 9.844 0 0 1 202.801 24.594 Q 203.788 23.66 205.1 22.85 A 11.381 11.381 0 0 1 208.209 21.554 Q 209.628 21.182 211.303 21.06 A 23.385 23.385 0 0 1 213 21 A 22.355 22.355 0 0 1 216.396 21.243 Q 218.18 21.517 219.645 22.103 A 11.002 11.002 0 0 1 221.5 23.05 Q 224.7 25.1 226.4 28.4 L 228.2 28.4 Q 229.9 25.2 233 23.1 A 10.704 10.704 0 0 1 235.948 21.741 Q 238.416 21 241.8 21 A 18.789 18.789 0 0 1 247.218 21.762 A 16.772 16.772 0 0 1 250.15 22.95 A 14.4 14.4 0 0 1 255.715 28.127 A 17.49 17.49 0 0 1 256.15 28.85 A 13.947 13.947 0 0 1 256.185 28.912 Q 258.156 32.414 258.373 37.513 A 30.26 30.26 0 0 1 258.4 38.8 L 258.4 71.4 L 245.8 71.4 L 245.8 39.7 Q 245.8 35.6 243.7 33.55 Q 241.735 31.632 238.28 31.509 A 13.497 13.497 0 0 0 237.8 31.5 A 10.749 10.749 0 0 0 235.018 31.84 A 7.514 7.514 0 0 0 231.15 34.25 A 8.996 8.996 0 0 0 229.43 37.451 Q 229.017 38.77 228.875 40.36 A 19.579 19.579 0 0 0 228.8 42.1 L 228.8 71.4 L 216.2 71.4 L 216.2 39.7 Q 216.2 35.6 214.1 33.55 Q 212.135 31.632 208.68 31.509 A 13.497 13.497 0 0 0 208.2 31.5 A 10.749 10.749 0 0 0 205.418 31.84 A 7.514 7.514 0 0 0 201.55 34.25 A 8.996 8.996 0 0 0 199.83 37.451 Q 199.417 38.77 199.275 40.36 A 19.579 19.579 0 0 0 199.2 42.1 L 199.2 71.4 Z M 578.2 71.4 L 565.6 71.4 L 565.6 21.8 L 578 21.8 L 578 27.2 L 579.8 27.2 A 9.844 9.844 0 0 1 581.801 24.594 Q 582.788 23.66 584.1 22.85 A 11.381 11.381 0 0 1 587.209 21.554 Q 588.628 21.182 590.303 21.06 A 23.385 23.385 0 0 1 592 21 A 22.355 22.355 0 0 1 595.396 21.243 Q 597.18 21.517 598.645 22.103 A 11.002 11.002 0 0 1 600.5 23.05 Q 603.7 25.1 605.4 28.4 L 607.2 28.4 Q 608.9 25.2 612 23.1 A 10.704 10.704 0 0 1 614.948 21.741 Q 617.416 21 620.8 21 A 18.789 18.789 0 0 1 626.218 21.762 A 16.772 16.772 0 0 1 629.15 22.95 A 14.4 14.4 0 0 1 634.715 28.127 A 17.49 17.49 0 0 1 635.15 28.85 A 13.947 13.947 0 0 1 635.185 28.912 Q 637.156 32.414 637.373 37.513 A 30.26 30.26 0 0 1 637.4 38.8 L 637.4 71.4 L 624.8 71.4 L 624.8 39.7 Q 624.8 35.6 622.7 33.55 Q 620.735 31.632 617.28 31.509 A 13.497 13.497 0 0 0 616.8 31.5 A 10.749 10.749 0 0 0 614.018 31.84 A 7.514 7.514 0 0 0 610.15 34.25 A 8.996 8.996 0 0 0 608.43 37.451 Q 608.017 38.77 607.875 40.36 A 19.579 19.579 0 0 0 607.8 42.1 L 607.8 71.4 L 595.2 71.4 L 595.2 39.7 Q 595.2 35.6 593.1 33.55 Q 591.135 31.632 587.68 31.509 A 13.497 13.497 0 0 0 587.2 31.5 A 10.749 10.749 0 0 0 584.418 31.84 A 7.514 7.514 0 0 0 580.55 34.25 A 8.996 8.996 0 0 0 578.83 37.451 Q 578.417 38.77 578.275 40.36 A 19.579 19.579 0 0 0 578.2 42.1 L 578.2 71.4 Z M 0 48.6 L 0 45.8 L 13 45.8 L 13 48.6 A 16.154 16.154 0 0 0 13.4 52.313 Q 14.044 55.038 15.722 56.928 A 9.847 9.847 0 0 0 16.9 58.05 Q 20.336 60.825 25.943 61.156 A 26.46 26.46 0 0 0 27.5 61.2 A 27.572 27.572 0 0 0 31.052 60.987 Q 35.206 60.446 37.608 58.534 A 8.688 8.688 0 0 0 37.65 58.5 A 9.141 9.141 0 0 0 39.998 55.746 A 8.556 8.556 0 0 0 41 51.6 A 8.297 8.297 0 0 0 40.75 49.507 A 6.044 6.044 0 0 0 39.35 46.9 A 9.204 9.204 0 0 0 37.547 45.403 Q 36.671 44.837 35.583 44.362 A 18.257 18.257 0 0 0 34.55 43.95 Q 32.138 43.07 28.935 42.277 A 87.568 87.568 0 0 0 26.9 41.8 L 24.6 41.3 Q 17.4 39.7 12.25 37.25 A 22.539 22.539 0 0 1 7.949 34.613 A 17.432 17.432 0 0 1 4.35 30.8 A 14.736 14.736 0 0 1 2.245 26.037 Q 1.741 24.055 1.631 21.73 A 28.073 28.073 0 0 1 1.6 20.4 A 22.426 22.426 0 0 1 2.226 14.98 A 17.365 17.365 0 0 1 4.65 9.45 A 18.927 18.927 0 0 1 11.257 3.443 A 23.564 23.564 0 0 1 13.25 2.45 A 27.806 27.806 0 0 1 19.904 0.503 Q 22.878 0.004 26.247 0 A 45.711 45.711 0 0 1 26.3 0 Q 33.8 0 39.65 2.55 A 21.141 21.141 0 0 1 46.768 7.508 A 20.415 20.415 0 0 1 48.85 10.15 A 19.368 19.368 0 0 1 51.582 16.74 Q 52.162 19.36 52.198 22.394 A 34.023 34.023 0 0 1 52.2 22.8 L 52.2 25.8 L 39.2 25.8 L 39.2 22.8 A 16.923 16.923 0 0 0 39.017 20.234 Q 38.804 18.847 38.343 17.708 A 8.496 8.496 0 0 0 37.65 16.35 A 8.927 8.927 0 0 0 33.656 12.943 A 11.081 11.081 0 0 0 33.2 12.75 Q 30.3 11.6 26.3 11.6 A 25.534 25.534 0 0 0 23.174 11.778 Q 19.499 12.233 17.45 13.85 A 7.259 7.259 0 0 0 14.634 19.167 A 9.978 9.978 0 0 0 14.6 20 A 8.311 8.311 0 0 0 14.868 22.157 A 6.506 6.506 0 0 0 15.95 24.4 A 8.148 8.148 0 0 0 17.634 26.047 Q 18.442 26.647 19.465 27.15 A 15.131 15.131 0 0 0 20 27.4 A 24.926 24.926 0 0 0 22.236 28.258 Q 24.275 28.938 26.9 29.5 L 29.2 30 Q 36.14 31.481 41.41 33.732 A 46.906 46.906 0 0 1 42.25 34.1 A 25.349 25.349 0 0 1 46.915 36.796 A 19.395 19.395 0 0 1 50.9 40.7 Q 54 44.8 54 51.2 A 21.324 21.324 0 0 1 53.028 57.737 A 18.628 18.628 0 0 1 50.75 62.45 A 20.822 20.822 0 0 1 44.066 68.722 A 26.199 26.199 0 0 1 41.55 70.05 Q 35.642 72.781 27.615 72.8 A 47.531 47.531 0 0 1 27.5 72.8 A 38.513 38.513 0 0 1 20.099 72.12 A 29.653 29.653 0 0 1 13.2 69.9 A 23.53 23.53 0 0 1 6.088 64.875 A 22.1 22.1 0 0 1 3.5 61.6 A 21.469 21.469 0 0 1 0.386 53.405 A 28.785 28.785 0 0 1 0 48.6 Z M 365 91.4 L 333.8 91.4 L 333.8 80.4 L 360.8 80.4 A 3.738 3.738 0 0 0 361.942 80.241 Q 363.158 79.851 363.482 78.505 A 4.73 4.73 0 0 0 363.6 77.4 L 363.6 64.9 L 361.8 64.9 Q 361.054 66.486 359.525 68.071 A 17.686 17.686 0 0 1 359.3 68.3 A 10.614 10.614 0 0 1 357.305 69.848 Q 356.333 70.44 355.147 70.925 A 18.843 18.843 0 0 1 354.7 71.1 Q 352.482 71.942 349.327 72.14 A 32.431 32.431 0 0 1 347.3 72.2 Q 341.5 72.2 337.15 69.55 Q 332.8 66.9 330.4 62.2 Q 328 57.5 328 51.4 L 328 21.8 L 340.6 21.8 L 340.6 50.4 A 18.168 18.168 0 0 0 340.855 53.553 Q 341.438 56.854 343.35 58.8 Q 345.925 61.422 350.559 61.589 A 17.78 17.78 0 0 0 351.2 61.6 Q 357 61.6 360.2 57.75 Q 362.898 54.504 363.321 49.09 A 26.827 26.827 0 0 0 363.4 47 L 363.4 21.8 L 376 21.8 L 376 80.2 A 14.042 14.042 0 0 1 375.578 83.737 A 10.054 10.054 0 0 1 373 88.35 Q 370 91.4 365 91.4 Z M 76.8 71.4 L 64.2 71.4 L 64.2 1.4 L 76.8 1.4 L 76.8 27.9 L 78.6 27.9 A 9.428 9.428 0 0 1 79.548 26.4 Q 80.065 25.723 80.744 25.046 A 16.886 16.886 0 0 1 81.1 24.7 A 10.792 10.792 0 0 1 83.017 23.279 Q 83.962 22.721 85.11 22.259 A 19.355 19.355 0 0 1 85.65 22.05 A 15.127 15.127 0 0 1 88.167 21.38 Q 89.455 21.146 90.956 21.056 A 32.602 32.602 0 0 1 92.9 21 Q 98.7 21 103.05 23.65 Q 107.4 26.3 109.8 30.95 Q 112.2 35.6 112.2 41.8 L 112.2 71.4 L 99.6 71.4 L 99.6 42.8 A 18.168 18.168 0 0 0 99.345 39.648 Q 98.762 36.347 96.85 34.4 Q 94.276 31.779 89.641 31.612 A 17.78 17.78 0 0 0 89 31.6 Q 83.2 31.6 80 35.45 Q 77.302 38.697 76.879 44.111 A 26.827 26.827 0 0 0 76.8 46.2 L 76.8 71.4 Z M 124.6 51.4 L 124.6 21.8 L 137.2 21.8 L 137.2 50.4 A 18.168 18.168 0 0 0 137.455 53.553 Q 138.038 56.854 139.95 58.8 Q 142.525 61.422 147.159 61.589 A 17.78 17.78 0 0 0 147.8 61.6 Q 153.6 61.6 156.8 57.75 Q 159.498 54.504 159.921 49.09 A 26.827 26.827 0 0 0 160 47 L 160 21.8 L 172.6 21.8 L 172.6 71.4 L 160.2 71.4 L 160.2 64.9 L 158.4 64.9 A 9.738 9.738 0 0 1 157.079 66.915 Q 155.86 68.375 153.9 69.8 A 10.596 10.596 0 0 1 150.948 71.263 Q 148.177 72.171 144.161 72.2 A 36.86 36.86 0 0 1 143.9 72.2 Q 138.1 72.2 133.75 69.55 Q 129.4 66.9 127 62.2 Q 124.6 57.5 124.6 51.4 Z M 443.4 47.3 L 443.4 45.9 Q 443.4 37.8 446.8 32.1 Q 450.2 26.4 456.05 23.4 A 27.478 27.478 0 0 1 466.774 20.481 A 33.058 33.058 0 0 1 469.1 20.4 Q 475.915 20.4 480.888 22.704 A 20.803 20.803 0 0 1 481.3 22.9 A 22.22 22.22 0 0 1 488.19 28.06 A 21.315 21.315 0 0 1 489.55 29.75 Q 492.7 34.1 493.7 39.6 L 481.5 42.2 A 14.977 14.977 0 0 0 480.478 38.359 A 13.373 13.373 0 0 0 479.7 36.8 Q 478.3 34.4 475.75 33 Q 473.444 31.734 470.116 31.613 A 19.679 19.679 0 0 0 469.4 31.6 A 15.085 15.085 0 0 0 465.152 32.182 A 13.27 13.27 0 0 0 462.55 33.25 A 11.641 11.641 0 0 0 457.974 37.75 A 14.038 14.038 0 0 0 457.75 38.15 A 13.994 13.994 0 0 0 456.388 41.997 Q 456.049 43.652 456.006 45.552 A 24.569 24.569 0 0 0 456 46.1 L 456 47.1 Q 456 51.364 457.441 54.435 A 12.453 12.453 0 0 0 457.75 55.05 A 12.211 12.211 0 0 0 460.526 58.558 A 11.406 11.406 0 0 0 462.55 59.95 A 13.805 13.805 0 0 0 468.174 61.556 A 16.704 16.704 0 0 0 469.4 61.6 A 17.627 17.627 0 0 0 472.694 61.312 Q 476.022 60.679 478.05 58.65 A 12.872 12.872 0 0 0 481.136 53.587 A 17.191 17.191 0 0 0 481.8 50.9 L 494 53.8 Q 492.7 59.1 489.55 63.45 A 21.792 21.792 0 0 1 481.617 70.142 A 25.411 25.411 0 0 1 481.3 70.3 A 23.504 23.504 0 0 1 475.317 72.251 Q 472.631 72.762 469.566 72.798 A 39.773 39.773 0 0 1 469.1 72.8 A 29.817 29.817 0 0 1 460.652 71.636 A 26.341 26.341 0 0 1 456.05 69.8 Q 450.2 66.8 446.8 61.1 Q 443.4 55.4 443.4 47.3 Z M 288 41.4 L 301.6 41.4 L 301.6 38.6 A 9.122 9.122 0 0 0 301.209 35.87 A 7.431 7.431 0 0 0 299.4 32.85 Q 297.734 31.146 294.577 30.733 A 16.794 16.794 0 0 0 292.4 30.6 A 16.355 16.355 0 0 0 289.821 30.79 Q 288.466 31.007 287.388 31.472 A 6.86 6.86 0 0 0 285.4 32.75 A 9.906 9.906 0 0 0 282.658 37.268 A 12.495 12.495 0 0 0 282.4 38.3 L 270.8 34.4 Q 272 30.6 274.65 27.45 A 17.382 17.382 0 0 1 278.666 23.982 A 22.778 22.778 0 0 1 281.75 22.35 Q 285.609 20.659 290.935 20.435 A 39.537 39.537 0 0 1 292.6 20.4 A 31.782 31.782 0 0 1 298.853 20.979 Q 304.36 22.085 308.1 25.3 Q 313.8 30.2 313.8 39.5 L 313.8 58 Q 313.8 60.553 315.827 60.934 A 4.192 4.192 0 0 0 316.6 61 L 320.6 61 L 320.6 71.4 L 312.2 71.4 A 12.506 12.506 0 0 1 309.508 71.126 A 8.73 8.73 0 0 1 306.1 69.6 Q 303.781 67.861 303.703 65.001 A 7.351 7.351 0 0 1 303.7 64.8 L 303.7 64.7 L 301.8 64.7 A 6.368 6.368 0 0 1 301.475 65.479 Q 300.985 66.479 300 67.85 Q 298.871 69.423 296.701 70.704 A 18.089 18.089 0 0 1 295.6 71.3 A 12.218 12.218 0 0 1 293.041 72.214 Q 291.771 72.526 290.258 72.672 A 29.834 29.834 0 0 1 287.4 72.8 A 26.041 26.041 0 0 1 282.079 72.278 A 20.928 20.928 0 0 1 277.9 70.95 A 15.975 15.975 0 0 1 273.046 67.697 A 14.986 14.986 0 0 1 271.25 65.55 A 13.64 13.64 0 0 1 269.064 60.08 A 18.426 18.426 0 0 1 268.8 56.9 Q 268.8 51.8 271.25 48.35 A 14.446 14.446 0 0 1 276.486 43.866 A 18.027 18.027 0 0 1 278.05 43.15 A 23.776 23.776 0 0 1 283.656 41.689 A 31.413 31.413 0 0 1 288 41.4 Z M 502 47.4 L 502 45.8 A 31.501 31.501 0 0 1 502.651 39.241 A 23.281 23.281 0 0 1 505.4 32.1 Q 508.8 26.4 514.7 23.4 A 27.741 27.741 0 0 1 524.614 20.565 A 34.104 34.104 0 0 1 528 20.4 A 31.395 31.395 0 0 1 535.851 21.35 A 26.627 26.627 0 0 1 541.3 23.4 Q 547.2 26.4 550.6 32.1 Q 554 37.8 554 45.8 L 554 47.4 A 31.501 31.501 0 0 1 553.349 53.96 A 23.281 23.281 0 0 1 550.6 61.1 Q 547.2 66.8 541.3 69.8 A 27.741 27.741 0 0 1 531.387 72.636 A 34.104 34.104 0 0 1 528 72.8 A 31.395 31.395 0 0 1 520.15 71.851 A 26.627 26.627 0 0 1 514.7 69.8 Q 508.8 66.8 505.4 61.1 Q 502 55.4 502 47.4 Z M 402.6 71.4 L 390 71.4 L 390 1.4 L 402.6 1.4 L 402.6 71.4 Z M 541.4 47.1 L 541.4 46.1 A 20.912 20.912 0 0 0 540.996 41.857 Q 540.17 37.87 537.65 35.35 A 12.651 12.651 0 0 0 529.704 31.683 A 17.168 17.168 0 0 0 528 31.6 A 14.703 14.703 0 0 0 523.193 32.357 A 12.572 12.572 0 0 0 518.4 35.35 A 12.117 12.117 0 0 0 515.277 40.773 Q 514.6 43.147 514.6 46.1 L 514.6 47.1 A 20.646 20.646 0 0 0 515.009 51.344 Q 515.559 53.96 516.847 55.943 A 11.362 11.362 0 0 0 518.4 57.85 Q 522.2 61.6 528 61.6 A 14.703 14.703 0 0 0 532.808 60.844 A 12.572 12.572 0 0 0 537.6 57.85 A 12.117 12.117 0 0 0 540.724 52.428 Q 541.4 50.054 541.4 47.1 Z M 424.6 72.8 Q 420.5 72.8 417.75 70.15 A 8.871 8.871 0 0 1 415.038 64.264 A 12.046 12.046 0 0 1 415 63.3 A 10.457 10.457 0 0 1 415.49 60.033 A 8.645 8.645 0 0 1 417.75 56.45 A 9.379 9.379 0 0 1 424.093 53.811 A 12.308 12.308 0 0 1 424.6 53.8 A 9.952 9.952 0 0 1 428.17 54.422 A 9.022 9.022 0 0 1 431.3 56.45 A 8.904 8.904 0 0 1 433.947 62.15 A 12.12 12.12 0 0 1 434 63.3 A 10.644 10.644 0 0 1 433.524 66.554 A 8.668 8.668 0 0 1 431.3 70.15 A 9.141 9.141 0 0 1 424.849 72.798 A 11.894 11.894 0 0 1 424.6 72.8 Z M 301.6 51.8 L 301.6 50.8 L 288.9 50.8 A 13.243 13.243 0 0 0 286.765 50.962 Q 285.628 51.148 284.706 51.548 A 6.432 6.432 0 0 0 283.4 52.3 Q 281.4 53.8 281.4 56.5 Q 281.4 59.2 283.5 60.9 Q 285.12 62.212 287.871 62.512 A 15.985 15.985 0 0 0 289.6 62.6 A 15.586 15.586 0 0 0 293.443 62.15 A 11.401 11.401 0 0 0 298.25 59.65 A 9.711 9.711 0 0 0 301.56 52.849 A 13.452 13.452 0 0 0 301.6 51.8 Z' /%3E%3C/svg%3E"
              style={{ margin: '0 30px' }}
              width={1000}
            />
          </div>
          <div
            style={{
              fontSize: 60,
              fontStyle: 'normal',
              letterSpacing: '-0.025em',
              color: 'white',
              marginTop: 30,
              padding: '0 120px',
              lineHeight: 1.4,
              whiteSpace: 'pre-wrap',
            }}
          >
            {title}
          </div>
        </div>
      ),
      {
        width: 1200,
        height: 630,
      },
    );
  } catch (e: any) {
    console.log(`${e.message}`);
    return new Response(`Failed to generate the image`, {
      status: 500,
    });
  }
}
